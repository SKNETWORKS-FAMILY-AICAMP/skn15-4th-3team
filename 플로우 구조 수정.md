## ğŸ’¡ í”„ë¡œì íŠ¸ íë¦„

ì•„ë˜ëŠ” ë°ì´í„° ì¸ë±ì‹±ê³¼ ì§ˆì˜ì‘ë‹µ ì „ì²´ êµ¬ì¡°ì…ë‹ˆë‹¤.

```mermaid
flowchart LR
  subgraph Ingestion [ ì¸ë±ì‹±(ì‚¬ì „ ì¤€ë¹„) ]
    A[ë³´í—˜ì‚¬ ì•½ê´€ PDFë“¤] --> L1[PyPDFLoader]
    L1 --> S1[ë¬¸ì„œ ë¶„í• \nSemantic / Recursive]
    S1 --> E1[OpenAIEmbeddings]
    E1 --> PGV[(PostgreSQL + pgvector)\nì—¬ëŸ¬ Collection]

    U1[ì‚¬ìš©ì ì—…ë¡œë“œ íŒŒì¼(pdf/txt)] --> L2[PDFPlumber/í…ìŠ¤íŠ¸ ë¡œë”]
    L2 --> S2[ë¬¸ì„œ ë¶„í• ]
    S2 --> E2[OpenAIEmbeddings(ìºì‹œ)]
    E2 --> F[(FAISS - ì„¸ì…˜ ì„ì‹œ ë²¡í„°DB)]
  end

  subgraph App [ ì§ˆì˜ ì‘ë‹µ(ëŸ°íƒ€ì„) ]
    UQ[ì‚¬ìš©ì ì§ˆë¬¸ + íˆìŠ¤í† ë¦¬\n(Streamlit UI)] --> ER[EnsembleRetriever\nMMR(k, fetch_k, lambda)]
    ER -->|Topâ€‘k| PGV
    ER -->|Topâ€‘k| F
    PGV --> R[ê´€ë ¨ ë¬¸ì„œë“¤]
    F --> R
    R --> FMT[format_docs\n(ì¶œì²˜/í˜ì´ì§€ í¬í•¨)]
    FMT --> PROMPT[ChatPromptTemplate\n(ì„œì‹Â·í‘œÂ·ì¶”ì²œë„Â·ì¶œì²˜)]
    PROMPT --> LLM[OpenAI Chat Model\ngpt-4.x / 4o-mini]
    LLM --> POST[render_answer\nì¤„ê°„ê²©/ë¶ˆë¦¿/ë°°ì§€ ì •ë¦¬]
    POST --> OUT[ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ\n(Streamlit Chat)]
  end
